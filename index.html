<!DOCTYPE html>
<html>
<head>
  <title>My Google Sheets App</title>
  <style>
    table { border-collapse: collapse; width: 50%; margin: 20px auto; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h1>Data from Google Sheets</h1>
  <div id="data"></div>
  <script>
    fetch('/api/data')
      .then(response => response.json())
      .then(data => {
        const dataDiv = document.getElementById('data');
        let table = '<table><tr>';
        // Add headers from first row
        data[0].forEach(header => table += `<th>${header}</th>`);
        table += '</tr>';
        // Add data rows
        for (let i = 1; i < data.length; i++) {
          table += '<tr>';
          data[i].forEach(cell => table += `<td>${cell}</td>`);
          table += '</tr>';
        }
        table += '</table>';
        dataDiv.innerHTML = table;
      })
      .catch(error => console.error('Error fetching data:', error));
  </script>
</body>
</html>